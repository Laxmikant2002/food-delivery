{
  "info": {
    "name": "Restaurant Service API v2",
    "description": "Collection for testing Restaurant Service API endpoints including success and error cases",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Update Restaurant",
      "item": [
        {
          "name": "Update Restaurant Details - Success",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"input\": {\n        \"name\": \"Updated Test Restaurant\",\n        \"description\": \"The best restaurant in town\",\n        \"isOnline\": true,\n        \"availabilityStart\": \"2025-05-27T09:00:00Z\",\n        \"availabilityEnd\": \"2025-05-27T22:00:00Z\"\n    },\n    \"menuItems\": [\n        {\n            \"name\": \"Super Pizza\",\n            \"description\": \"Our signature pizza\",\n            \"price\": 16.99\n        },\n        {\n            \"name\": \"Deluxe Burger\",\n            \"description\": \"Premium beef burger\",\n            \"price\": 14.99\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/restaurants/{{restaurantId}}",
              "host": ["{{baseUrl}}"],
              "path": ["restaurants", "{{restaurantId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Restaurant Details - Unauthorized",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"input\": {\n        \"name\": \"Updated Test Restaurant\"\n    },\n    \"menuItems\": []\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/restaurants/{{restaurantId}}",
              "host": ["{{baseUrl}}"],
              "path": ["restaurants", "{{restaurantId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Restaurant Details - Invalid Data",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"input\": {\n        \"name\": \"\",\n        \"description\": \"Invalid restaurant data\",\n        \"isOnline\": \"not-a-boolean\",\n        \"availabilityStart\": \"invalid-date\",\n        \"availabilityEnd\": \"invalid-date\"\n    },\n    \"menuItems\": [\n        {\n            \"name\": \"\",\n            \"description\": \"\",\n            \"price\": \"not-a-number\"\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/restaurants/{{restaurantId}}",
              "host": ["{{baseUrl}}"],
              "path": ["restaurants", "{{restaurantId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Order Management",
      "item": [
        {
          "name": "Accept Order - Success",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{baseUrl}}/orders/{{orderId}}/accept",
              "host": ["{{baseUrl}}"],
              "path": ["orders", "{{orderId}}", "accept"]
            }
          },
          "response": []
        },
        {
          "name": "Accept Order - Already Accepted",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{baseUrl}}/orders/{{orderId}}/accept",
              "host": ["{{baseUrl}}"],
              "path": ["orders", "{{orderId}}", "accept"]
            }
          },
          "response": []
        },
        {
          "name": "Assign Delivery Agent - Success",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"deliveryAgentId\": \"{{deliveryAgentId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/orders/{{orderId}}/assign-agent",
              "host": ["{{baseUrl}}"],
              "path": ["orders", "{{orderId}}", "assign-agent"]
            }
          },
          "response": []
        },
        {
          "name": "Assign Delivery Agent - Order Not Accepted",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"deliveryAgentId\": \"{{deliveryAgentId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/orders/{{unacceptedOrderId}}/assign-agent",
              "host": ["{{baseUrl}}"],
              "path": ["orders", "{{unacceptedOrderId}}", "assign-agent"]
            }
          },
          "response": []
        },
        {
          "name": "Assign Delivery Agent - Missing Agent ID",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{restaurantToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{baseUrl}}/orders/{{orderId}}/assign-agent",
              "host": ["{{baseUrl}}"],
              "path": ["orders", "{{orderId}}", "assign-agent"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "pm.test(\"Response status code\", () => {",
          "    if (pm.response.code === 200) {",
          "        pm.response.to.have.status(200);",
          "        pm.response.to.have.jsonBody();",
          "    } else if (pm.response.code === 400) {",
          "        pm.response.to.have.status(400);",
          "        pm.expect(pm.response.json()).to.have.property('error');",
          "    } else if (pm.response.code === 401) {",
          "        pm.response.to.have.status(401);",
          "        pm.expect(pm.response.json()).to.have.property('error');",
          "    } else if (pm.response.code === 404) {",
          "        pm.response.to.have.status(404);",
          "        pm.expect(pm.response.json()).to.have.property('error');",
          "    }",
          "});"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:4001/api",
      "type": "string"
    },
    {
      "key": "restaurantToken",
      "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyZXN0YXVyYW50SWQiOiJiNjBhMzliMi1hNjZmLTQzMjQtYWM0NC1kNjUwMzdkYWU0OWYiLCJpYXQiOjE3NDgzMjk2MTIsImV4cCI6MTc0ODMzMzIxMn0.9t6aJVhDDg38Z_r1DRW2Rx7-FORe-4n_vQogEnqYt2o",
      "type": "string"
    },
    {
      "key": "restaurantId",
      "value": "b60a39b2-a66f-4324-ac44-d65037dae49f",
      "type": "string"
    },
    {
      "key": "orderId",
      "value": "83d30442-c9bb-4cb5-b7c1-26440ffd286b",
      "type": "string"
    },
    {
      "key": "unacceptedOrderId",
      "value": "pending-order-id",
      "type": "string"
    },
    {
      "key": "deliveryAgentId",
      "value": "agent-123",
      "type": "string"
    }
  ]
}
